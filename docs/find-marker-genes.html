<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.7 Find marker genes | Analysis of MOB Visium data using STutility</title>
  <meta name="description" content="5.7 Find marker genes | Analysis of MOB Visium data using STutility" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="5.7 Find marker genes | Analysis of MOB Visium data using STutility" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.7 Find marker genes | Analysis of MOB Visium data using STutility" />
  
  
  

<meta name="author" content="Authors: Lovisa Franzén, Ludvig Larsson, Mengxiao He" />


<meta name="date" content="2022-04-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="clustering.html"/>
<link rel="next" href="wrap-up.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="assets/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="assets/datatables-binding-0.22/datatables.js"></script>
<link href="assets/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="assets/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="assets/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://www.embo.org/"><img src="imgs/logo_embo.png" width="80"></a>
<a href="https://spatialresearch.org/"><img src="imgs/logo_spatial-research.png" width="80"></a>
<a href="https://www.kth.se/"><img src="imgs/logo_kth.png" width="40"></a>
<a href="https://www.scilifelab.se/"><img src="imgs/logo_scilifelab.png" width="80"></a>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="set-up.html"><a href="set-up.html"><i class="fa fa-check"></i><b>2</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1" data-path="assemble-input-files.html"><a href="assemble-input-files.html"><i class="fa fa-check"></i><b>2.1</b> Assemble input files</a></li>
<li class="chapter" data-level="2.2" data-path="import-data.html"><a href="import-data.html"><i class="fa fa-check"></i><b>2.2</b> Import data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="he-images.html"><a href="he-images.html"><i class="fa fa-check"></i><b>3</b> H&amp;E images</a>
<ul>
<li class="chapter" data-level="3.1" data-path="load-images.html"><a href="load-images.html"><i class="fa fa-check"></i><b>3.1</b> Load images</a></li>
<li class="chapter" data-level="3.2" data-path="mask-images.html"><a href="mask-images.html"><i class="fa fa-check"></i><b>3.2</b> Mask images</a></li>
<li class="chapter" data-level="3.3" data-path="process-images.html"><a href="process-images.html"><i class="fa fa-check"></i><b>3.3</b> Process images</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="quality-control-and-filtering.html"><a href="quality-control-and-filtering.html"><i class="fa fa-check"></i><b>4</b> Quality control and filtering</a>
<ul>
<li class="chapter" data-level="4.1" data-path="basic-qc-metrics.html"><a href="basic-qc-metrics.html"><i class="fa fa-check"></i><b>4.1</b> Basic QC metrics</a></li>
<li class="chapter" data-level="4.2" data-path="other-metrics.html"><a href="other-metrics.html"><i class="fa fa-check"></i><b>4.2</b> Other metrics</a></li>
<li class="chapter" data-level="4.3" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>4.3</b> Filter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-analysis.html"><a href="data-analysis.html"><i class="fa fa-check"></i><b>5</b> Data analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="normalization.html"><a href="normalization.html"><i class="fa fa-check"></i><b>5.1</b> Normalization</a></li>
<li class="chapter" data-level="5.2" data-path="dimensionality-reduction.html"><a href="dimensionality-reduction.html"><i class="fa fa-check"></i><b>5.2</b> Dimensionality reduction</a></li>
<li class="chapter" data-level="5.3" data-path="data-integration.html"><a href="data-integration.html"><i class="fa fa-check"></i><b>5.3</b> Data integration</a></li>
<li class="chapter" data-level="5.4" data-path="spatial-color-projection.html"><a href="spatial-color-projection.html"><i class="fa fa-check"></i><b>5.4</b> Spatial color projection</a></li>
<li class="chapter" data-level="5.5" data-path="non-negative-matrix-factorization.html"><a href="non-negative-matrix-factorization.html"><i class="fa fa-check"></i><b>5.5</b> Non-negative matrix factorization</a></li>
<li class="chapter" data-level="5.6" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>5.6</b> Clustering</a></li>
<li class="chapter" data-level="5.7" data-path="find-marker-genes.html"><a href="find-marker-genes.html"><i class="fa fa-check"></i><b>5.7</b> Find marker genes</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="wrap-up.html"><a href="wrap-up.html"><i class="fa fa-check"></i><b>6</b> Wrap up</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of MOB Visium data using STutility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="find-marker-genes" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Find marker genes<a href="find-marker-genes.html#find-marker-genes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To see which genes are present in each cluster we can run the Seurat function <code>FindAllMarkers()</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="find-marker-genes.html#cb32-1" aria-hidden="true" tabindex="-1"></a>gene_markers <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(se.cor, <span class="at">only.pos =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="find-marker-genes.html#cb32-2" aria-hidden="true" tabindex="-1"></a>gene_markers<span class="sc">$</span>cluster_annotation <span class="ot">&lt;-</span> <span class="fu">factor</span>(plyr<span class="sc">::</span><span class="fu">mapvalues</span>(<span class="at">x =</span> gene_markers<span class="sc">$</span>cluster, <span class="at">from =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">to =</span> cluster_annotations), </span>
<span id="cb32-3"><a href="find-marker-genes.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;L0&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), <span class="st">&quot;L10&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="find-marker-genes.html#cb33-1" aria-hidden="true" tabindex="-1"></a>top3_genes <span class="ot">&lt;-</span> gene_markers <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="find-marker-genes.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_val_adj <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="find-marker-genes.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster_annotation) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="find-marker-genes.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="at">wt =</span> avg_log2FC, <span class="at">n =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="find-marker-genes.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(cluster_annotation)</span>
<span id="cb33-6"><a href="find-marker-genes.html#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="find-marker-genes.html#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(top3_genes, <span class="at">rownames =</span> F, <span class="at">caption =</span> <span class="fu">paste</span>(<span class="st">&quot;Top three marker genes for each cluster&quot;</span>))</span></code></pre></div>
<div id="htmlwidget-d45dda206e72d42d8b04" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d45dda206e72d42d8b04">{"x":{"filter":"none","vertical":false,"caption":"<caption>Top three marker genes for each cluster<\/caption>","data":[[1.43252590107717e-79,7.94114879421775e-66,1.89937178882646e-51,1.1269982093435e-154,5.54386830409067e-102,9.81255760213211e-82,8.6129175027057e-90,3.39705581991217e-75,3.1164582993882e-23,3.34214348996882e-87,4.23236650018726e-80,3.93135671504914e-79,1.19265237460359e-111,1.16425134478006e-78,1.0021083012538e-71,2.15501686372113e-83,9.6392102169653e-65,1.42908615335491e-50,9.44187830234032e-26,1.33454024738325e-25,9.72622421319868e-24,1.14899094837785e-207,2.85439909675578e-202,6.54311030628543e-159,1.49898326155507e-126,9.19189085277483e-99,3.75631719038665e-74,5.61882414197131e-25,6.06682157560508e-25,1.29894558680001e-08],[3.35608339953331,3.54987006995919,3.63948504908571,1.94634880440888,1.29291687096724,1.48416300636871,1.11655166448201,1.10647743471783,1.13028024292058,1.70708833009571,1.61670525234682,1.63635842057148,1.84221744407202,1.25815444668359,1.30050070714656,2.43310079237579,1.65515299039315,1.25377329365077,1.05896990267932,1.10191439786993,0.885589275015727,3.08501049214573,2.88765899882603,3.78892666590972,1.37876205955994,1.32126938790402,1.30138407183845,1.82352806488752,1.67297957475251,1.80356837041256],[1,1,1,0.948,0.997,0.938,1,0.993,1,0.994,0.959,0.976,1,0.909,1,1,0.971,1,1,1,1,1,1,1,0.99,0.993,0.709,1,0.907,0.953],[0.211,0.287,0.509,0.385,0.89,0.809,1,0.634,0.943,0.778,0.39,0.554,0.858,0.489,0.981,0.7,0.569,0.847,0.867,0.982,0.902,0.626,0.801,0.826,0.658,0.78,0.333,0.904,0.355,0.818],[1.57935980593758e-75,8.75511654562506e-62,2.09405739718118e-47,1.2425155258012e-150,6.11211480525996e-98,1.08183447563506e-77,9.49574154673304e-86,3.74525404145317e-71,3.43589527507549e-19,3.68471319769062e-83,4.66618406645646e-76,4.33432077834168e-75,1.31489924300046e-107,1.28358710762001e-74,1.10482440213232e-67,2.37590609225254e-79,1.06272292642042e-60,1.57556748407378e-46,1.04096708283302e-21,1.47133062274003e-21,1.07231621950515e-19,1.26676252058658e-203,3.14697500417324e-198,7.21377911267969e-155,1.65262904586446e-122,1.01340596651843e-94,4.14133970240128e-70,6.19475361652337e-21,6.6886707871046e-21,0.000143208750944702],["8","8","8","2","2","2","3","3","3","5","5","5","4","4","4","6","6","6","7","7","7","1","1","1","0","0","0","9","9","9"],["Hba-a2","Hba-a1","Hbb-bs","Nrgn","Mbp","Ppp3ca","mt-Rnr2","Doc2g","Gm42418","Uchl1","Slc17a7","Gabra1","Pcp4","Cpne6","Gad1","Cck","Cdhr1","Olfm1","Pcp4","Gad1","Mbp","Apod","Fabp7","Ptgds","Nrsn1","Calb2","Th","Mbp","Mobp","Tmsb10"],["L01","L01","L01","L02","L02","L02","L03","L03","L03","L04","L04","L04","L05","L05","L05","L06","L06","L06","L07","L07","L07","L08","L08","L08","L09","L09","L09","L10","L10","L10"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>p_val<\/th>\n      <th>avg_log2FC<\/th>\n      <th>pct.1<\/th>\n      <th>pct.2<\/th>\n      <th>p_val_adj<\/th>\n      <th>cluster<\/th>\n      <th>gene<\/th>\n      <th>cluster_annotation<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[0,1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="find-marker-genes.html#cb34-1" aria-hidden="true" tabindex="-1"></a>top5_genes <span class="ot">&lt;-</span> gene_markers <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="find-marker-genes.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(p_val_adj <span class="sc">&lt;</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="find-marker-genes.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster_annotation) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="find-marker-genes.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="at">wt =</span> avg_log2FC, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="find-marker-genes.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(cluster_annotation)</span>
<span id="cb34-6"><a href="find-marker-genes.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="find-marker-genes.html#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(se.cor, <span class="at">features =</span> <span class="fu">unique</span>(top5_genes<span class="sc">$</span>gene), <span class="at">group.by =</span> <span class="st">&quot;cluster_annotation&quot;</span>) <span class="sc">+</span> </span>
<span id="cb34-8"><a href="find-marker-genes.html#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_gradientn</span>(<span class="at">colours =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">name =</span> <span class="st">&quot;RdBu&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">rev</span>()) <span class="sc">&amp;</span> </span>
<span id="cb34-9"><a href="find-marker-genes.html#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># coord_flip() &amp; </span></span>
<span id="cb34-10"><a href="find-marker-genes.html#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;Cluster marker genes&quot;</span>) <span class="sc">&amp;</span> </span>
<span id="cb34-11"><a href="find-marker-genes.html#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<div class="figure">
<img src="STUtility-analysis_files/figure-html/marker_dotplot-1.png" alt="Dot plot of top 5 marker genes per cluster." width="1800" />
<p class="caption">
(#fig:marker_dotplot)Dot plot of top 5 marker genes per cluster.
</p>
</div>
<p>Do you see any genes that you recognize?</p>
<p><br></p>
<p>Let’s do a few more plots :)</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="find-marker-genes.html#cb35-1" aria-hidden="true" tabindex="-1"></a>col_scale <span class="ot">&lt;-</span> viridis<span class="sc">::</span><span class="fu">magma</span>(<span class="at">n =</span> <span class="dv">11</span>, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb35-2"><a href="find-marker-genes.html#cb35-2" aria-hidden="true" tabindex="-1"></a>col_spectral <span class="ot">&lt;-</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">10</span>, <span class="at">name =</span> <span class="st">&quot;Spectral&quot;</span>)</span>
<span id="cb35-3"><a href="find-marker-genes.html#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="find-marker-genes.html#cb35-4" aria-hidden="true" tabindex="-1"></a>plot_genes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Nrgn&quot;</span>, <span class="st">&quot;Apod&quot;</span>)</span>
<span id="cb35-5"><a href="find-marker-genes.html#cb35-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">FeaturePlot</span>(se.cor, <span class="at">features =</span> plot_genes, <span class="at">cols =</span> col_scale, <span class="at">reduction =</span> <span class="st">&quot;umap.harmony&quot;</span>)</span>
<span id="cb35-6"><a href="find-marker-genes.html#cb35-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">VlnPlot</span>(se.cor, <span class="at">features =</span> plot_genes, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">group.by =</span> <span class="st">&quot;cluster_annotation&quot;</span>, <span class="at">cols =</span> col_spectral)</span>
<span id="cb35-7"><a href="find-marker-genes.html#cb35-7" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ST.FeaturePlot</span>(se.cor, <span class="at">features =</span> plot_genes, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">grid.ncol =</span> <span class="dv">2</span>, <span class="at">show.sb =</span> <span class="cn">FALSE</span>, <span class="at">cols =</span> col_scale, <span class="at">label.by =</span> <span class="st">&quot;slide_id&quot;</span>)</span>
<span id="cb35-8"><a href="find-marker-genes.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="find-marker-genes.html#cb35-9" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">-</span> p2)<span class="sc">/</span>p3</span></code></pre></div>
<div class="figure">
<img src="STUtility-analysis_files/figure-html/plot_markers_spatial-1.png" alt="Top left: marker expression in UMAP embedding, top right: marker expression per cluster as a violin plot, bottom: marker expression on tissue sections." width="1800" />
<p class="caption">
(#fig:plot_markers_spatial)Top left: marker expression in UMAP embedding, top right: marker expression per cluster as a violin plot, bottom: marker expression on tissue sections.
</p>
</div>
<p><br><br></p>
<p>Here we can see how the neuronal gene Nrgn is highly expressed in clusters 1, 2, and 9, which are all present in the inner parts of the MOB tissue (granule cell layer etc), while the Apod gene is a marker of oligodendrocytes and is expressed in clusters 0 and 5, present in the outermost layers of the tissue.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="clustering.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrap-up.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
