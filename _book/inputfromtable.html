<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 InputFromTable | Analysis of MOB Visium data using STutility</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 InputFromTable | Analysis of MOB Visium data using STutility" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 InputFromTable | Analysis of MOB Visium data using STutility" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="L. Franzén, L. Larsson, M. He" />


<meta name="date" content="2022-04-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="infotable.html"/>

<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="assets/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="assets/datatables-binding-0.22/datatables.js"></script>
<link href="assets/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="assets/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="assets/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="set-up.html"><a href="set-up.html"><i class="fa fa-check"></i><b>2</b> Set up</a>
<ul>
<li class="chapter" data-level="2.1" data-path="infotable.html"><a href="infotable.html"><i class="fa fa-check"></i><b>2.1</b> infoTable</a></li>
<li class="chapter" data-level="2.2" data-path="inputfromtable.html"><a href="inputfromtable.html"><i class="fa fa-check"></i><b>2.2</b> InputFromTable</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis of MOB Visium data using STutility</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="inputfromtable" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> InputFromTable<a href="inputfromtable.html#inputfromtable" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It’s time to import the data into R using the function <code>InputFromTable</code> and providing our <code>infoTable</code> to point at where the data is located. In addition, we can perform some initial quality filtering of the data, for instance removing spots and genes with very low UMI counts.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="inputfromtable.html#cb3-1" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">InputFromTable</span>(<span class="at">infotable =</span> infoTable, </span>
<span id="cb3-2"><a href="inputfromtable.html#cb3-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minSpotsPerGene =</span> <span class="dv">5</span>,</span>
<span id="cb3-3"><a href="inputfromtable.html#cb3-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minUMICountsPerGene =</span> <span class="dv">100</span>,</span>
<span id="cb3-4"><a href="inputfromtable.html#cb3-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">minUMICountsPerSpot =</span> <span class="dv">500</span>,</span>
<span id="cb3-5"><a href="inputfromtable.html#cb3-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">platform =</span>  <span class="st">&quot;Visium&quot;</span>, </span>
<span id="cb3-6"><a href="inputfromtable.html#cb3-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">verbose =</span> T)</span></code></pre></div>
<pre><code>## Using spotfiles to remove spots outside of tissue
## Loading ../data/V19D02-087_B1/filtered_feature_bc_matrix.h5 count matrix from a &#39;Visium&#39; experiment
## Loading ../data/V19T26-013_A1/filtered_feature_bc_matrix.h5 count matrix from a &#39;Visium&#39; experiment
## 
## ------------- Filtering (not including images based filtering) -------------- 
##   Spots removed:  23  
##   Genes removed:  37684  
## Saving capture area ranges to Staffli object 
## After filtering the dimensions of the experiment is: [11025 genes, 2346 spots]</code></pre>
<p><br></p>
<p>To check everything looks ok, we can do a few plots of the data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="inputfromtable.html#cb5-1" aria-hidden="true" tabindex="-1"></a>col_scale <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;lightgray&quot;</span>, <span class="st">&quot;mistyrose&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb5-2"><a href="inputfromtable.html#cb5-2" aria-hidden="true" tabindex="-1"></a>col_samples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#1954A6&quot;</span>, <span class="st">&quot;#A7C947&quot;</span>)</span>
<span id="cb5-3"><a href="inputfromtable.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(se, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>), <span class="at">group.by =</span> <span class="st">&quot;slide_id&quot;</span>, <span class="at">cols =</span> col_samples)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_se-1.png" width="100%" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="inputfromtable.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ST.FeaturePlot</span>(se, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>), <span class="at">cols =</span> col_scale, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">pt.size =</span> <span class="fl">1.8</span>, <span class="at">label.by =</span> <span class="st">&quot;slide_id&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_se-2.png" width="100%" /></p>
<p>Seems like the data is in! From these plots you can clearly see that one of the tissues is of lower quality and thus have fewer unique genes (nFeature_RNA) and UMIs (n_CountRNA).</p>
<p>We can also easily plot the spatial locations of a few selected genes. The MOB consists of multiple layers, including the glomerular layer, the external plexiform layer, the mitral cell layer, the internal plexiform layer, and the granule cell layer. A few known gene markers for a couple of these layers are Cdhr1 and Camk2a, so let’s plot and see how it looks.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="inputfromtable.html#cb7-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ST.FeaturePlot</span>(se, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;Cdhr1&quot;</span>, <span class="st">&quot;Camk2a&quot;</span>), <span class="at">indices =</span> <span class="dv">1</span>, <span class="at">max.cutoff =</span> <span class="dv">10</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">grid.ncol =</span> <span class="dv">1</span>, <span class="at">cols =</span> col_scale, <span class="at">label.by =</span> <span class="st">&quot;slide_id&quot;</span>)</span>
<span id="cb7-2"><a href="inputfromtable.html#cb7-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ST.FeaturePlot</span>(se, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;Cdhr1&quot;</span>, <span class="st">&quot;Camk2a&quot;</span>), <span class="at">indices =</span> <span class="dv">2</span>, <span class="at">max.cutoff =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">grid.ncol =</span> <span class="dv">1</span>, <span class="at">cols =</span> col_scale, <span class="at">label.by =</span> <span class="st">&quot;slide_id&quot;</span>)</span>
<span id="cb7-3"><a href="inputfromtable.html#cb7-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">-</span> p2</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/plot_se_genes-1.png" width="100%" /></p>
<p>As one can see, the sample of poorer quality is also more sparse in its gene expression of these marker genes. To address this issue and to be able to analyze these two sections together we need to proceed with the next steps of the analysis. But first of all it can be good to perform some more quality control and filter the data further.</p>

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="infotable.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
